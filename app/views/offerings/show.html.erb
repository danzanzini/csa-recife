<p id="notice"><%= notice %></p>

<h1>
  Oferenda para o dia <strong><%= @offering.closes_at.strftime('%d/%m') %></strong>
</h1>
<p>
  <strong>Encerra em:</strong>
  <%= @offering.closes_at.strftime('%d/%m (%A) Ã s %H:%M') %>
</p>

<p>
  <strong>Publicada:</strong>
  <%= @offering.published %>
</p>

<%= form_with(model: [@offering, @offer]) do |form| %>
  <% if @offer.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@offer.errors.count, "error") %> prohibited this offer from being saved:</h2>

      <ul>
        <% @offer.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="row">
    <div class="field col-md-4 mb-2">
      <%= form.label :product_name %>
      <%= form.text_field :product_name, class: "form-control" %>
    </div>
    <div class="field col-md-4 mb-2">
      <%= form.label :amount %>
      <%= form.text_field :amount, class: "form-control" %>
    </div>

    <div class="col-md-4 mb-2">
      <%= form.submit 'Adicionar item', class: "btn btn-primary btn-md btn-block" %>
    </div>
  </div>
<% end %>

<ul class='list-group'>
  <% @offering.offers.order(product_name: :asc).each do |offer| %>
    <% next unless offer.persisted? %>
    <li class='list-group-item'>
      <div class='d-flex justify-content-between'>
        <span>
          <%= offer.product_name %>: <%= offer.amount %>
        </span>
        <%= link_to offering_offer_url(@offering.id, offer.id), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-danger' do %>
          <i class='fas fa-trash fa-sm'></i>
        <% end %>
      </div>
    </li>
  <% end %>
</ul>

<%= link_to 'Edit', edit_offering_path(@offering) %> |
<%= link_to 'Back', offerings_path %>
